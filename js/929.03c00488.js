"use strict";(self["webpackChunkctwing_shop_h5"]=self["webpackChunkctwing_shop_h5"]||[]).push([[929],{2224:function(s,t,e){e.r(t),e.d(t,{default:function(){return A}});var a=function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"confirmOrder"},[a("div",{staticClass:"oredr-box"},[a("div",{staticClass:"card margin-b-9"},[a("div",{staticClass:"contacts"},[a("div",{staticClass:"contacts-box",on:{click:s.handleOpenAddress}},[a("img",{staticClass:"address-img",attrs:{src:e(3509)}}),a("div",{staticClass:"contacts-text-box"},[a("div",{staticClass:"contacts-address"},[s._v(" "+s._s(s.addressDto.addrDetail)+" ")]),a("div",{staticClass:"contacts-name"},[a("span",{staticClass:"m-r-9"},[s._v(s._s(s.addressDto.contacter))]),a("span",[s._v(s._s(s.addressDto.contactPhone))])])])]),a("img",{staticClass:"right-icon",attrs:{src:e(4568)}})])]),s.productInfoDto?[a("orderDetailsGoods",{attrs:{item:s.productInfoDto}})]:s._e(),a("div",{staticClass:"order-remark"},[a("div",[s._v("订单留言")]),a("div",{staticClass:"order-remark-content",on:{click:s.onClickOrderRemarkBtnClick}},[a("span",{staticClass:"nowrap remark ell"},[s._v(s._s(s.orderRemark))]),a("img",{staticClass:"right-icon",attrs:{src:e(4568)}})])]),a("div",{staticClass:"card margin-b-9"},[a("div",{staticClass:"total"},[a("div",{staticClass:"item"},[a("span",[s._v("总金额")]),a("span",{staticClass:"num"},[s._v("¥ "+s._s(s.calcOrderPriceDto.amountMonthTotal||0))])]),a("div",{staticClass:"item"},[a("span",[s._v("优惠")]),a("span",{staticClass:"num red"},[s._v("- ¥ "+s._s(s.calcOrderPriceDto.discAmtTotal||0))])]),a("div",{staticClass:"item"},[a("span",[s._v("实付额")]),a("span",{staticClass:"num"},[s._v("¥ "+s._s(s.calcOrderPriceDto.shouldAmtTotal||0))])]),s._m(0),s._m(1),a("div",{staticClass:"item"},[a("span",[s._v("商品数")]),a("span",{staticClass:"num"},[s._v(s._s(s.kindCopiesDto.kind)+" 种 "+s._s(s.kindCopiesDto.copies)+" 件")])])])]),a("div",{staticClass:"card margin-b-9"},[a("div",{staticClass:"total"},[a("div",{staticClass:"item"},[a("span",[s._v("支付方式")]),a("div",{staticClass:"wxplay"},[a("img",{staticClass:"wxplay-img",attrs:{src:e(6078)}}),a("span",[s._v("微信支付")])])])])])],2),a("div",{staticClass:"submit-order"},[a("div",{staticClass:"checkbox"},[a("van-checkbox",{attrs:{"icon-size":"16px"},model:{value:s.checked,callback:function(t){s.checked=t},expression:"checked"}},[s._v(" 购买商品需同意 ")]),a("a",{staticClass:"tcp"},[s._v("《物联网市场服务协议》")])],1),a("div",{staticClass:"submit"},[a("div",{staticClass:"submit-text"},[a("span",[s._v("总计:")]),a("span",{staticClass:"money"},[s._v("￥")]),a("span",{staticClass:"money-num"},[s._v(s._s(s.calcOrderPriceDto.shouldAmtTotal||0))])]),a("div",[a("van-button",{attrs:{type:"info"},on:{click:s.onSaveOrderBtnClick}},[s._v("提交订单")])],1)])]),a("productSendTo",{ref:"sendToRef",on:{onAddress:s.onAddress}}),a("van-popup",{staticClass:"message-popup-panel",style:{height:"400px"},attrs:{closeable:"","close-icon":"close",position:"bottom"},model:{value:s.showMessagePop,callback:function(t){s.showMessagePop=t},expression:"showMessagePop"}},[a("div",{staticClass:"title-name-panel"},[s._v("订单留言")]),a("div",{staticClass:"message-content"},[a("van-field",{attrs:{type:"textarea",maxlength:"500",placeholder:"请输入留言","show-word-limit":""},model:{value:s.message,callback:function(t){s.message=t},expression:"message"}})],1),a("div",{staticClass:"save-btn",on:{click:s.onSaveMessageBtnClick}},[s._v("确定")])])],1)},r=[function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"item"},[e("span",[s._v("支付方式")]),e("span",{staticClass:"num"},[s._v("在线支付")])])},function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"item"},[e("span",[s._v("订单数")]),e("span",{staticClass:"num"},[s._v("3")])])}],o=(e(7658),e(9059)),i=e(4185),d=e(5045),c=e(1614),n=e.n(c),l={name:"ConfirmOrder",components:{productSendTo:o.Z,orderDetailsGoods:i.Z,orderDetailsMessage:d.Z},data(){return{checked:!1,type:1,addressObj:{},orderParams:null,productInfoDto:null,showMessagePop:!1,message:"",orderRemark:"",addressDto:null,calcOrderPriceDto:{amountMonthTotal:0,discAmtTotal:0,shouldAmtTotal:0},kindCopiesDto:null}},created(){this.orderParams=JSON.parse(this.$route.query.orderDto),this.addressDto=JSON.parse(this.$route.query.addressDto),this.kindCopiesDto=JSON.parse(this.$route.query.kindCopiesDto)},mounted(){this.$nextTick((()=>{this.queryAepOrderDetailInfo(),this.calcOneItemWithMonthPre()}))},methods:{handleOpenAddress(){this.$refs.sendToRef.showPopup=!0,this.$refs.sendToRef.initChangeSelectAddressId(this.addressDto.addrId)},onAddress(s){this.addressDto=s,console.log(this.addressDto)},onClickOrderRemarkBtnClick(){this.showMessagePop=!0},onSaveMessageBtnClick(){this.showMessagePop=!1,this.orderRemark=this.message},onSaveOrderBtnClick(){this.checked?this.submit():this.$toast.fail("请先同意《物联网市场服务协议》")},queryAepOrderDetailInfo(){this.$api.queryAepOrderDetailInfo({custOrderId:this.orderParams.custOrderId}).then((s=>{"core.0000"===s.code?(this.productInfoDto=s.data,setTimeout((()=>{this.$refs.orderDetailsMessage&&this.$refs.orderDetailsMessage.Details(s.data)}),100)):this.$toast.fail(s.reason)}))},calcOneItemWithMonthPre(){this.$api.calcOneItemWithMonthPre({custOrderId:this.orderParams.custOrderId}).then((s=>{"0"===s.code?this.calcOrderPriceDto=s.data:this.$toast.fail("服务器报错，请稍后重试！")}))},saveOrderCommont(){this.$api.saveOrderCommont({orderCommentId:"",orderItemId:this.orderParams.orderItems[0].orderItemId,orderItemNbr:this.orderParams.orderItems[0].orderItemNbr,orderStatus:this.orderParams.orderItems[0].statusCd,commentType:0,commentContent:this.message}).then((s=>{"core.0000"===s.code?(this.calcOrderPriceDto=s.data,n().miniProgram.navigateTo({url:"/pages/payOrder/payOrder"})):this.$toast.fail("服务器报错，请稍后重试！")}))},submit(){let s=[];_.forEach(this.orderParams.orderItems,(t=>{s.push({orderItem:{orderItemId:t.orderItemId},orderRecvInfos:[{addrId:this.addressDto.addrId,addrType:"recv_addr",operType:"ADD",orderItemId:t.orderItemId,recvAddress:this.addressDto.addrDetail,recvBranchId:this.addressDto.cityId}]})})),this.$api.submit({payMethodNbr:"XSZF_1000",baseInfo:{custOrderId:this.orderParams.custOrderId,userId:this.orderParams.userId,tenantId:this.orderParams.tenantId,serviceTypeId:"1",endFlag:2,orderSrc:this.orderParams.orderSrc},customerOrder:{totalFee:this.orderParams.totalFee||0,discountFee:this.orderParams.discountFee||0,payAmount:this.orderParams.payAmount||0},orderItemReqs:s}).then((s=>{"0"===s.code?(this.$toast.success(s.data),this.saveOrderCommont()):this.$toast.fail(s.reason)}))}}},m=l,h=e(3736),p=(0,h.Z)(m,a,r,!1,null,"cb142b34",null),A=p.exports},4568:function(s){s.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAAXNSR0IArs4c6QAAANVJREFUOE+d0rEKgmAQB/A7BaHwAT6l5+gBbGqpMRwdRFwFlzBwaHb2HJL2XqxGQQtCLxyEMD+tvv13/7vvDuHPh386+IBJksx0Xb/Ude34vn+TFR5MJKIDAOyaprFkWNpqhxVFWbmue+0nj86YpmkEALaqqlYfT35OlmURM9tFUSzDMCy75FEYx7FiGMaJmReIuPY87zkJWySEyBHRLMtyEwTB/X3OwcQWmaaZM/MgagsMQSSiMzOLqqq2/SRpq0Q0B4Cjpml7x3EePx3AN2c4uQ5ZkRcrn1APcjuj1QAAAABJRU5ErkJggg=="},6078:function(s){s.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAA8hJREFUWEfFlm+IVGUUxn/n7m7lGLakYDEha7WggmQ7N4SwMjIICvoQK6KkpXOv9aF/IOH6oYTAEmUxF8q9M2ub4QcLpKjoU4hGsLB3ZiJajfwSLEuSmeZW7Lo798Q7487O7MydP/uHzsd7n/M8z3ve9z3nFf7nkIb0My+1MTn5KCJrgHtQXYplAXod+JVAhwhkgPWJX+rlrW1gIL6cZtmJ8CJKe53EF0BOYE300fHR5Wo54QYGti2hObIXeBVYXKdwKUwZA44icgDb+6sSR2UDvrsB9BOgbVbCM5OEEVSex/bOlP+a+WUwvh2RPqB5XsSnSbJY1ht09PYU85ZWIOU4wDEUc7IWKvZhJ96dIp82kHY2EfDNAqx8eiHC7wg9PBg9gOwPzI+8gcwLrQQtP6FEF2TZIhdR7WbpRD8r+83BLETeQMo5iPLmvIsLA2AdouPuz6dWjO+2gL4Gsgjbe0fw3TsgGAGZ3VUrP9YByNcQHCKW/K7kd3r3E2hwFMU0sj8ZnYgaA3HQRMjqtbBNtcojjAMnQQ8TS14ogfvuCiwOE2hnyfdAtwh+/CTI1or8qluxWInyNsgtIR6ugRzLNRzb+60Ec/GVW7k2vgdLu9AKzUw4LqSc8yirQ8gPYif24rtrEe1Deajo+Axj6REi2QSrjo+W5fvu06BHgPvDiycZwXcmgaYQ0Aij0TYe3z+JdjaRbt2Cso5AfSzrNLY3UUH4vpvCz9TaNeCyMOhcQlhexeVmbO+zmmS+GwHtAvYAt9XE5wB6xWzB9ygPhyaIniOWfKwqYdp5joBuYEV9wgXUz2YLksCucAMo6DpiyR/LMKn4ahBzrTY1KJyHi5wy13AHaH9VAhGPmLe7gMmN6sVvgZpR3TIrcZNkSZcxsOxmIwq7ZqZh/4NKOzHvEil3OwTvgdw1a+GpRNE1+VacdpIEVbYhn3AVZBx07sK58nOWWGJj3oDpVOgQcPucV1UXgSpW00Y6es9Nj2PffRn0g7ry5w5KYCfcfCGKY9DpQ9g5d/4qDCo+y248MjWWSw182tnEva0fA9sWxoRkyI49yfoTVwrnsExIMc3JPJnM+6D2s71+p1+A7Jj5Og4X8J0fgAfq5w9FXgX2EUv0IqaplUZlA/mtMBNu0RwM/AH6Idkb7xeXvD4DvrsKtPhRYcr3FaJPoWyAisMrAD2PWGdBv+R69NvcFK0RlSuQcjajnAIZRuR1Yr2nS3iGdt3JmJgJGsGSLEHwN0siw7T3mFdRQ1HZQCb+LFlZC9KN7f3bEGOD4Pk85Q1K5+H/AfurLsvU6CovAAAAAElFTkSuQmCC"}}]);